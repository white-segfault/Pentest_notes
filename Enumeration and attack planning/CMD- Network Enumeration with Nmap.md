## Host Enumeration
#### Host Discovery

```shell-session
areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d" " -f5

## Scan IP List

areaeric@htb[/htb]$ cat hosts.lst

areaeric@htb[/htb]$ sudo nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d" " -f5

## Scan Multiple IPs
areaeric@htb[/htb]$ sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20| grep for | cut -d" " -f5

areaeric@htb[/htb]$ sudo nmap -sn -oA tnet 10.129.2.18-20| grep for | cut -d" " -f5

## Scan single IPs
areaeric@htb[/htb]$ sudo nmap 10.129.2.18 -sn -oA host 

areaeric@htb[/htb]$ sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace 

areaeric@htb[/htb]$ sudo nmap 10.129.2.18 -sn -oA host -PE --reason 

areaeric@htb[/htb]$ sudo nmap 10.129.2.18 -sn -oA host -PE --packet-trace --disable-arp-ping 

// Questions
-> TTL128 -> Windows operating system from googling
```

#### Host and Port Scanning
```
## Discvoering Open TCP ports
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 --top-ports=10 

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 21 --packet-trace -Pn -n --disable-arp-ping

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 443 --packet-trace --disable-arp-ping -Pn -n --reason -sT 

## Flitered Ports
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 139 --packet-trace -n --disable-arp-ping -Pn

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 445 --packet-trace -n --disable-arp-ping -Pn

## Discovering Open UDP Ports

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -F -sU

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -sU -Pn -n --disable-arp-ping --packet-trace -p 137 --reason

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -sU -Pn -n --disable-arp-ping --packet-trace -p 100 --reason 

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -Pn -n --disable-arp-ping --packet-trace -p 445 --reason  -sV

## Questions
sudo nmap -sV 10.129.59.97 
```

#### Saving the Results
```
## Different formats
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p- -oA target

areaeric@htb[/htb]$ ls

areaeric@htb[/htb]$ cat target.nmap

areaeric@htb[/htb]$ cat target.gnmap

areaeric@htb[/htb]$ cat target.xml

## Style sheet
areaeric@htb[/htb]$ xsltproc target.xml -o target.html

## Questions
- Follow directly from sections
```

#### Service Enumeration
```
## Service Version Detection
```shell-session
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p- -sV
```shell-session
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p- -sV --stats-every=5s
```shell-session
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p- -sV -v 

## Banner Grabbing
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p- -sV

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p- -sV -Pn -n --disable-arp-ping --packet-trace

areaeric@htb[/htb]$ sudo tcpdump -i eth0 host 10.10.14.2 and 10.129.2.28

areaeric@htb[/htb]$  nc -nv 10.129.2.28 25

18:28:07.128564 IP 10.10.14.2.59618 > 10.129.2.28.smtp: Flags [S], seq 1798872233, win 65535, options [mss 1460,nop,wscale 6,nop,nop,TS val 331260178 ecr 0,sackOK,eol], length 0
18:28:07.255151 IP 10.129.2.28.smtp > 10.10.14.2.59618: Flags [S.], seq 1130574379, ack 1798872234, win 65160, options [mss 1460,sackOK,TS val 1800383922 ecr 331260178,nop,wscale 7], length 0
18:28:07.255281 IP 10.10.14.2.59618 > 10.129.2.28.smtp: Flags [.], ack 1, win 2058, options [nop,nop,TS val 331260304 ecr 1800383922], length 0
18:28:07.319306 IP 10.129.2.28.smtp > 10.10.14.2.59618: Flags [P.], seq 1:36, ack 1, win 510, options [nop,nop,TS val 1800383985 ecr 331260304], length 35: SMTP: 220 inlane ESMTP Postfix (Ubuntu)
18:28:07.319426 IP 10.10.14.2.59618 > 10.129.2.28.smtp: Flags [.], ack 36, win 2058, options [nop,nop,TS val 331260368 ecr 1800383985], length 0

// Questions
sudo nmap 10.129.59.97 -sV
or
sudo tcpdump -i tun0 host 10.10.16.12 and 10.129.59.9
nc -nv 10.129.59.97 31337
```

#### Nmap Scripting Engine
```shell-session
areaeric@htb[/htb]$ sudo nmap <target> -sC

areaeric@htb[/htb]$ sudo nmap <target> --script <category>

areaeric@htb[/htb]$ sudo nmap <target> --script <script-name>,<script-name>,...

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 25 --script banner,smtp-commands

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 80 -A

## Vulnerability Assessment
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 80 -sV --script vuln 

## Questions
sudo nmap 10.129.59.97 -p22,80,110,139,143,445,31337 -sVC 

sudo nmap 10.129.59.97 -p22,80,110,139,143,445,31337 --script banner

sudo nmap 10.129.59.97 -p22,80,110,139,143,445,31337 -A

sudo nmap 10.129.59.97 -p 80 --script vuln
- Access robots.txt page
```

#### Performance
```
## Timeouts
areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -F

areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -F --initial-rtt-timeout 50ms --max-rtt-timeout 100ms

areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -F | grep "/tcp" | wc -l

23

areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -F --max-retries 0 | grep "/tcp" | wc -l

21

areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -F -oN tnet.default

<SNIP>
Nmap done: 256 IP addresses (10 hosts up) scanned in 29.83 seconds

areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -F -oN tnet.minrate300 --min-rate 300

<SNIP>
Nmap done: 256 IP addresses (10 hosts up) scanned in 8.67 seconds

areaeric@htb[/htb]$ cat tnet.default | grep "/tcp" | wc -l

23

areaeric@htb[/htb]$ cat tnet.minrate300 | grep "/tcp" | wc -l

23

## Timing
areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -F -oN tnet.default 

<SNIP>
Nmap done: 256 IP addresses (10 hosts up) scanned in 32.44 seconds

areaeric@htb[/htb]$ sudo nmap 10.129.2.0/24 -F -oN tnet.T5 -T 5

<SNIP>
Nmap done: 256 IP addresses (10 hosts up) scanned in 18.07 seconds

areaeric@htb[/htb]$ cat tnet.default | grep "/tcp" | wc -l

23

areaeric@htb[/htb]$ cat tnet.T5 | grep "/tcp" | wc -l

23
```

## Bypass Security Measures
```
## IDS/IPS
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 21,22,25 -sS -Pn -n --disable-arp-ping --packet-trace

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 21,22,25 -sA -Pn -n --disable-arp-ping --packet-trace

## Decoys
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -n -Pn -p445 -O

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -n -Pn -p 445 -O -S 10.129.2.200 -e tun0

## DNS Proxying
areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace

areaeric@htb[/htb]$ sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53

areaeric@htb[/htb]$ ncat -nv --source-port 53 10.129.2.28 50000
```
