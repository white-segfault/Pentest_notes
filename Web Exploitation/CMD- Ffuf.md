## Introduction
#### Web Fuzzing
```shell-session
areaeric@htb[/htb]$ locate directory-list-2.3-small.txt

Tip: Taking a look at this wordlist we will notice that it contains copyright comments at the beginning, which can be considered as part of the wordlist and clutter the results. We can use the following in `ffuf` to get rid of these lines with the `-ic` flag.
```

## Basic Fuzzing
#### Directory Fuzzing
```
## Directory Fuzzing
areaeric@htb[/htb]$ ffuf -h

areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ

areaeric@htb[/htb]$ ffuf -w <SNIP> -u http://SERVER_IP:PORT/FUZZ

areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ

## Exercise
- Remember wordlist on our local VM:
/opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt

- Reference template command for fuzzing:
ffuf -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -ic -u http://94.237.62.195:47466/FUZZ
```

#### Page Fuzzing
```
## Extension Fuzzing

areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ <SNIP>

Note: The wordlist we chose already contains a dot (.), so we will not have to add the dot after "index" in our fuzzing.

areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ

## Page Fuzzing
areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php

## Exercise
- Follow directly from section
```

#### Recursive Fuzzing
```
## Recursive Flags

Note: we can still use `.php` as our page extension, as these extensions are usually site-wide.

areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v

## Exercise
- Follow section, but for to speed up the proceed can directly proceed with fuzzing the forum web page. 
```

## Domain Fuzzing

#### DNS Records
```shell-session
areaeric@htb[/htb]$ sudo sh -c 'echo "SERVER_IP  academy.htb" >> /etc/hosts'
```

#### Sub-domain Fuzzing
```
## Sub-domain

areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u https://FUZZ.inlanefreight.com/

areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://FUZZ.academy.htb/

## Exercises
- Follow directly from section
```

#### Vhost Fuzzing
```
## Vhost Fuzzing
areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb'
```

#### Filtering Results
```
## Filerting
areaeric@htb[/htb]$ ffuf -h

areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs 900

Note 1: Don't forget to add "admin.academy.htb" to "/etc/hosts".

Note 2: If your exercise has been restarted, ensure you still have the correct port when visiting the website.

## Questions
ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:55468/ -H 'Host: FUZZ.academy.htb' 
-> default response size is 986
ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:55468/ -H 'Host: FUZZ.academy.htb' -fs 986
```

## Parameter Fuzzing
#### Parameter Fuzzing - Get
```
**Tip:** Fuzzing parameters may expose unpublished parameters that are publicly accessible. Such parameters tend to be less tested and less secured, so it is important to test such parameters for the web vulnerabilities we discuss in other modules.

## Get Request Fuzzing
Once again, we will get many results back, so we will filter out the default response size we are getting.

ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx

## Questions
ffuf -w /opt/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:55468/admin/admin.php?FUZZ=key 
-> Default size is 798
ffuf -w /opt/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:55468/admin/admin.php?FUZZ=key -fs 798
```

#### Parameter Fuzzing - POST
```
Tip: In PHP, "POST" data "content-type" can only accept "application/x-www-form-urlencoded". So, we can set that in "ffuf" with "-H 'Content-Type: application/x-www-form-urlencoded'".
	
areaeric@htb[/htb]$ ffuf -w /opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx

areaeric@htb[/htb]$ curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'
```

#### Value Fuzzing
```
## Custom Wordlist
Tactics:
- Look for wordlist suiting your parameter value under seclist
- Create your own wordlist:
- E.g:
areaeric@htb[/htb]$ for i in $(seq 1 1000); do echo $i >> ids.txt; done

areaeric@htb[/htb]$ cat ids.txt

## Value Fuzzing
areaeric@htb[/htb]$ ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx

## Exercises
for i in $(seq 1 1000); do echo $i >> ids.txt; done

ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:55468/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded'
-> Default response size is 768
ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:55468/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs 768
-> Value is 73
curl http://admin.academy.htb:55468/admin/admin.php -X POST -d 'id=73' -H 'Content-Type: application/x-www-form-urlencoded'
```


## Skill assessment - Web Fuzzing
```
You are given an online academy's IP address but have no further information about their website. As the first step of conducting a Penetration Test, you are expected to locate all pages and domains linked to their IP to enumerate the IP and domains properly.

Finally, you should do some fuzzing on pages you identify to see if any of them has any parameters that can be interacted with. If you do find active parameters, see if you can retrieve any data from them.

83.136.255.150:48796

Q1:
Perform vhost fuzzing on '*.academy.htb'
- Edited /etc/hosts

ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:48796/ -H 'Host: FUZZ.academy.htb'
-> Default response size is 985
ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:48796/ -H 'Host: FUZZ.academy.htb' -fs 985
-> test, archive, faculty

Q2 Before you run your page fuzzing scan, you should first run an extension fuzzing scan. What are the different extensions accepted by the domains?
- Add vhosts to /etc/hosts

ffuf -w /opt/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://academy.htb:48796/indexFUZZ
-> .phps, php

ffuf -w /opt/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://test.academy.htb:48796/indexFUZZ
-> .phps, php

ffuf -w /opt/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://archive.academy.htb:48796/indexFUZZ
-> .phps, php

ffuf -w /opt/SecLists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://faculty.academy.htb:48796/indexFUZZ
-> .php, .php7, .phps

Q3: One of the pages you will identify should say 'You don't have access!'. What is the full page URL?
- Perform recursive fuzzing on subdomains and domains:

ffuf -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -ic -u http://faculty.academy.htb:48796/FUZZ -recursion -recursion-depth 1 -e .php,phps,php7 -v
-> Found http://faculty.academy.htb:48796/courses/linux-security.php7
- To speed up the process, can directly search for it:
ffuf -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -ic -u http://faculty.academy.htb:49221/courses/FUZZ -recursion -recursion-depth 1 -e .php,.phps,.php7 -v -fs 287
-> http://faculty.academy.htb:49221/courses/linux-security.php7

Q4: In the page from the previous question, you should be able to find multiple parameters that are accepted by the page. What are they?
- Get/Post Fuzzing

## Get Fuzzing:
ffuf -w /opt/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:49221/courses/linux-security.php7?FUZZ=key
-> Default response size is 774
ffuf -w /opt/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:49221/courses/linux-security.php7?FUZZ=key -fs 774
-> User

## Post fuzzing
ffuf -w /opt/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:49221/courses/linux-security.php7 -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded'
-> Default response size is 774
ffuf -w /opt/SecLists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://faculty.academy.htb:49221/courses/linux-security.php7 -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs 774
-> user, username

curl http://faculty.academy.htb:49221/courses/linux-security.php7 -X POST -d 'username=key' -H 'Content-Type: application/x-www-form-urlencoded'



Try fuzzing the parameters you identified for working values. One of them should return a flag. What is the content of the flag?

## Value fuzzing
- Appropriate word lists under /opt/SecLists/Usernames
- Attempt on xato-net-10-million-usernames-dup.txt

#### Fuzzing on post request

###### On username post parameter
ffuf -w /opt/SecLists/Usernames/xato-net-10-million-usernames-dup.txt:FUZZ -u http://faculty.academy.htb:49221/courses/linux-security.php7 -X POST -d 'username=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' 
-> Default response size is 781
ffuf -w /opt/SecLists/Usernames/xato-net-10-million-usernames-dup.txt:FUZZ -u http://faculty.academy.htb:49221/courses/linux-security.php7 -X POST -d 'username=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs 781
-> harry got 200

curl http://faculty.academy.htb:49221/courses/linux-security.php7 -X POST -d 'username=harry' -H 'Content-Type: application/x-www-form-urlencoded'

-> No need to attempt other parameters.

```

