## Introduction
#### Intro to File Inclusions
```
bc= File is being read from the website through some parameter

## Local File Inclusion (LFI)
C= bc
P= Gain a better understanding of LFI and where they might come from (e.g. template engine, index.php sets the header and footer and decide te body of the content through the parameter)

## Examples of vulnerable code
C= bc
P= To gain a better understanding of LFI and the source code of it (from a developer's perspective), which help us better exploit LFI.

## Read vs Execute
C= bc
P= To gain a appreciation of read vs execute difference on different functions that performs file inclusion- notable ones with execute can possibly lead to rce under the right condition.
```

## File Disclosure
#### Local File Inclusion (LFI)
```
bc= File is being read from the website through some parameter

## Basic LFI
C= bc
P= Reading files through absolute path, setting up for further attacks/furthering our access

## Path Traversal
C= bc
P= Reading files through relative path, setting up for further attacks/furthering our access

## Filename Prefix
C= bc
P= To illustrate how filename prefix may be used for LFI and how it could stop LFI.

## Appended Extensions
C= bc
P= To read files of the extension type, which sets up for further attack.

## Second-Order Attacks
C= bc
P= To illustrate the conocept of Second-Order attack

## Questions
-> To illustrate how relaive path traversal works and reading files from it. 
```


## Basic Bypasses
```
bc= File is being read from the website through some parameter

## Non-recursive Path traversal Filters
C= bc
P= Bypass non-recursive Path traversal Filters for LFI. 


## Encoding
C= bc
P= Bypass some basic filters that does not handle url encoded data. 

## Approved Paths
C= bc
P= Bypass filters that uses approved paths filter.

## Appended Extension
C= bc, older versions of PHP (version below before 5.3/5.4 for path truncation, 5.5 for Null bytes,)
P= Bypass appended extension for LFI. 

## Exercises:
-> Illustrates how we can bypass multiple LFI filters (Approved path + non-recursive filter here)
```

#### PHP Filters
```
bc= Identified at least a weak LFI (LFI on a minimum of current level directory) 

## Input filter
C= bc
P= To gain a better understanding of PHP Filters related to LFI. 

## Fuzzing for PHP files
C= bc
P= To look for related PHP files that we can read, sets up for Standard PHP Inclusion and Source Code Disclosure

## Standard PHP Inclusion
C= bc
P= To see what happens when we include the file.

## Source Code Disclosure
C= bc, have file to be read (we can even start from index.php)
P= To uncover the functionality of the website, also allowing the setting up of future attack. 

## Question
-> To illustrate the potential fruit (DB password) that we can reap through LFI source code disclosure, as well as the steps to perform it properly.
```

#### PHP Wrappers
```
bc= Identified at least a weak LFI (LFI on a minimum of current level directory)

## Data / ## Input
C= bc, allow_url_include enabled
P= To obtain rce

## Expect
C= bc, expect installed and enabled
P= To obtain rce

## Questions
-> Illustrated how we can enable RCE through various PHP wrappers. More notably, the expect module didn't quite work out, which is suprisingly and may indicate that we should not be too reliant on it. 
```

#### Remote File Inclusion (RFI)
```
bc= have a LFI

## Local vs. Remote File Inclusion
C= bc
P= Better understanding of the difference between local and remote file inclusion

## Verify RFI
C= bc
P= To verify/test that there is an RFI, sets up for RCE with RFI.

## Remote Code Execution with RFI
C= bc, there is a confirmed RFI
P= Sets up for RCE for the various protocols below

## HTTP 
C= bc, there is a confirmed RFI
P= RCE on the target

## FTP
C= bc, there is a confirmed RFI and we want to bypass possible WAF that the target implements
P= RCE on the target

## SMB
C= bc, target using windows system
P= RCE on te windows target

## Questions
-> Illustrate how we can achieve RCE when RFI is enabled.
```

#### LFI and File Uploads
```
bc= have a place to upload file, have a weak LFI weakness somewhere

## Image upload
C= bc
P= To perform RCE

## Zip Upload / ## Phar upload
C= bc, Image upload technique fails
P= To perform RCE

## Questions
-> Illustrate how we can use the three techniques, Image upload, Zip Upload or Phar upload to perform RCE if we could upload file, know where it got uploaded, and include it in some LFI weakness. 
```

#### Log Poisoning
```
bc= have a LFI vulnerability

## PHP Session Poisoning
C= bc, there is a cookie file, cookie file can be read, contains parameter we can manipulate and poison
P= Achieve RCE

## Server Log Poisoning
C= bc, there is a sever log we could read. 
P= Achieve RCE

## Questions
-> Illustrate how we can perform log poisoning techniques (on PHP session files and server logs) and can even generalise beyond (poisoning on any type of log files)
```

## Automation and Prevention
#### Automated Scanning
```
bc= Have a website to target

## Fuzzing Parameters
C= bc
P= Expose parameters that would be hidden under usual means.

## LFI wordlists
C= bc, have an exposed parameter (not that handy for manual testing) or just have an parameter that we want to test on and is unrelated to forms. 
P= test whether the parameter is vulnerable to LFI

## Fuzzing Server Files
C= bc, have a parameter vulnerable to LFI
P= To obtain location of various useful files (configuration files, server logs, webroot) to set up for further LFI attacks

##  LFI tools
C= bc
P= Gain a better understanding for additional tools for LFI testing

## Questions
-> Illustrated how we can expose parameter for LFI testing (nice to see the combo with ffuf) and perform automated testing on such parameters, then testing on LFI and even exposing various location of server files, setting up for some LFI attacks. 

-> Also illustrated the LFI wordlists testing can potentially be done on non-exposed parameter, as sometimes the payload is tricky ot determine (look at those ../../../../../../../../../../../../../../../../.., missing one of the ../ would fail to identify the LFI vulnerability)
	- Combining manual and automated testing for the most optimal testing.
```


#### File Inclusion Prevention
```
bc= have administrative control of the webserver and can web server settings

## File Inclusion Prevention / ## Preventing Directory traversal
/ ## Web Server Configuration / ## Web Application Firewall (WAF)
C= bc
P= Restrict attacker as much as possible

## Questions
-> Illustrate the location for php.ini file and how to harden systems against attacker (disabling system calls)
```

## Skills assessment
```
Illustrate how in file inclusion attack, the vulnerability usually starts small (e.g. a weak LFI) but then it can uncover more important info, eventually leading to RCE. 

Also showed how log poisoning is probably one of the most potent attacks, because it can always work (assuming you can read the log files), but with other attacks, it requires other more specific conditions (such as dangerous wrappers enabled for RFI or upload files and know its location for File upload attacks.)

```

